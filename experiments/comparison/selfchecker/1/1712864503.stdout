[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 15629461307450008826
xla_global_id: -1
]
Dense layers and associated activation layers are considered: ['dense', 'dense_1', 'dense_2', 'dense_3', 'dense_4', 'dense_5']
Number of classes: 2
[94m### y_train len:800 ###[0m
[92m### y_valid len:100 ###[0m
[94m[train] [0mModel serving

1/7 [===>..........................] - ETA: 1s
7/7 [==============================] - 0s 2ms/step
[94m[train] [0mProcessing ATs
Layer: dense
Layer: dense_1
Layer: dense_2
Layer: dense_3
Layer: dense_4
Layer: dense_5
[92mtrain ATs is saved at /experiments/comparison/selfchecker/1/GC5/train_dense_dense_1_dense_2_dense_3_dense_4_ats.npy[0m
[94m[valid] [0mModel serving

1/1 [==============================] - ETA: 0s
1/1 [==============================] - 0s 54ms/step
[94m[valid] [0mProcessing ATs
Layer: dense
Layer: dense_1
Layer: dense_2
Layer: dense_3
Layer: dense_4
Layer: dense_5
[92mvalid ATs is saved at /experiments/comparison/selfchecker/1/GC5/valid_dense_dense_1_dense_2_dense_3_dense_4_ats.npy[0m
[94mLayer: dense[0m
layer_index: 0, var_threshold: 1e-05
[94mcalc kdes...[0m

kde:   0%|          | 0/2 [00:00<?, ?it/s]refined ats shape: (62, 561)
refined ats min max 0.0 ; 1.2469054460525513 
min_kde: 8.280152321793158e+52
max_kde: 6.673755259932629e+53
refined ats shape: (62, 239)
refined ats min max 0.0 ; 1.1827071905136108 
min_kde: 1.3777893793137715e+53
max_kde: 3.691583309446488e+53

kde: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 41.18it/s]
gaussian_kde(refined_ats) shape[1] sum: 800
[92mThe number of removed columns: 2[0m
[94m[dense] [0mFetching KDE inference

valid:   0%|          | 0/2 [00:00<?, ?it/s]
valid: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 174.83it/s]
model accuracy: valid, 0.72
kde accuracy:valid, 0.65
[94mLayer: dense_1[0m
layer_index: 1, var_threshold: 0
[94mcalc kdes...[0m

kde:   0%|          | 0/2 [00:00<?, ?it/s]refined ats shape: (32, 561)
refined ats min max 0.0 ; 1.505805492401123 
min_kde: 1.9529674956502924e+27
max_kde: 3.2210292120259572e+28
refined ats shape: (32, 239)
refined ats min max 0.0 ; 1.5302594900131226 
min_kde: 3.6722177652615067e+27
max_kde: 1.37440426010479e+28

kde: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 76.45it/s]
gaussian_kde(refined_ats) shape[1] sum: 800
[92mThe number of removed columns: 0[0m
[94m[dense_1] [0mFetching KDE inference

valid:   0%|          | 0/2 [00:00<?, ?it/s]
valid: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 288.58it/s]
model accuracy: valid, 0.72
kde accuracy:valid, 0.64
[94mLayer: dense_2[0m
layer_index: 2, var_threshold: 0
[94mcalc kdes...[0m

kde:   0%|          | 0/2 [00:00<?, ?it/s]refined ats shape: (16, 561)
refined ats min max 0.0 ; 2.019566774368286 
LinAlgError: singular matrix
refined_ats shape: (16, 561)
refined_ats min max 0.0 ; 2.019566774368286 
Regularizing KDE
min_kde: 61988.570825588264
max_kde: 3882055.567134258
refined ats shape: (16, 239)
refined ats min max 0.0 ; 2.0192372798919678 
LinAlgError: singular matrix
refined_ats shape: (16, 239)
refined_ats min max 0.0 ; 2.0192372798919678 
Regularizing KDE
min_kde: 124320.37670998622
max_kde: 2573030.463114469

kde: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 100.55it/s]
gaussian_kde(refined_ats) shape[1] sum: 800
[92mThe number of removed columns: 0[0m
[94m[dense_2] [0mFetching KDE inference

valid:   0%|          | 0/2 [00:00<?, ?it/s]
valid: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 423.39it/s]
model accuracy: valid, 0.72
kde accuracy:valid, 0.7
[94mLayer: dense_3[0m
layer_index: 3, var_threshold: 0
[94mcalc kdes...[0m

kde:   0%|          | 0/2 [00:00<?, ?it/s]refined ats shape: (8, 561)
refined ats min max 0.0 ; 3.145643711090088 
LinAlgError: singular matrix
refined_ats shape: (8, 561)
refined_ats min max 0.0 ; 3.145643711090088 
Regularizing KDE
min_kde: 90.83855816678867
max_kde: 2914.589146284107
refined ats shape: (8, 239)
refined ats min max 0.0 ; 3.12465238571167 
LinAlgError: singular matrix
refined_ats shape: (8, 239)
refined_ats min max 0.0 ; 3.12465238571167 
Regularizing KDE
min_kde: 211.60164336287306
max_kde: 2731.162162205001

kde: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 127.51it/s]
gaussian_kde(refined_ats) shape[1] sum: 800
[92mThe number of removed columns: 0[0m
[94m[dense_3] [0mFetching KDE inference

valid:   0%|          | 0/2 [00:00<?, ?it/s]
valid: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 684.90it/s]
model accuracy: valid, 0.72
kde accuracy:valid, 0.6
[94mLayer: dense_4[0m
layer_index: 4, var_threshold: 0
[94mcalc kdes...[0m

kde:   0%|          | 0/2 [00:00<?, ?it/s]refined ats shape: (4, 561)
refined ats min max 0.0 ; 3.392225980758667 
LinAlgError: singular matrix
refined_ats shape: (4, 561)
refined_ats min max 0.0 ; 3.392225980758667 
Regularizing KDE
min_kde: 1.4501889489204578
max_kde: 27.277544081735435
refined ats shape: (4, 239)
refined ats min max 0.0 ; 3.3393094539642334 
LinAlgError: singular matrix
refined_ats shape: (4, 239)
refined_ats min max 0.0 ; 3.3393094539642334 
Regularizing KDE
min_kde: 2.844337048053916
max_kde: 28.929530031191366

kde: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 143.44it/s]
gaussian_kde(refined_ats) shape[1] sum: 800
[92mThe number of removed columns: 0[0m
[94m[dense_4] [0mFetching KDE inference

valid:   0%|          | 0/2 [00:00<?, ?it/s]
valid: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 897.56it/s]
model accuracy: valid, 0.72
kde accuracy:valid, 0.58
[94mLayer: dense_5[0m
layer_index: 5, var_threshold: 0
[94mcalc kdes...[0m

kde:   0%|          | 0/2 [00:00<?, ?it/s]refined ats shape: (1, 561)
refined ats min max 0.001996635692194104 ; 0.04641151800751686 
min_kde: 0.4819639357435904
max_kde: 115.23710748845558
refined ats shape: (1, 239)
refined ats min max 0.0021080581936985254 ; 0.03512656316161156 
min_kde: 1.137244011593162
max_kde: 91.00149397569633

kde: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 331.78it/s]
gaussian_kde(refined_ats) shape[1] sum: 800
[92mThe number of removed columns: 0[0m
[94m[dense_5] [0mFetching KDE inference

valid:   0%|          | 0/2 [00:00<?, ?it/s]
valid: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 1758.25it/s]
model accuracy: valid, 0.72
kde accuracy:valid, 0.58
label: 0
count: 1
count: 2
count: 3
count: 4
count: 5
count: 6
selected layers: (1, 2, 4)
TPR:0.678571 FPR:0.277778 F1:0.567164 TP:19 FP:20 FN:9 TN:52
label: 1
count: 1
count: 2
count: 3
count: 4
count: 5
count: 6
selected layers: (0, 1, 2, 3, 4, 5)
TPR:0.000000 FPR:0.000000 F1:0.000000 TP:0 FP:0 FN:0 TN:0
label: 0
label: 0, total_len: 39, label_con: 0, len: 20
selected layers: (0, 5), acc: 0.6
model acc: 1.0

label: 0, total_len: 39, label_con: 1, len: 19
selected layers: (0, 1, 2, 4, 5), acc: 1.0
model acc: 0.0

label: 1
label: 1, total_len: 0, label_con: 0, len: 0
check!
label: 1, total_len: 0, label_con: 1, len: 0
check!
label: 0
label: 0, total_len: 61, label_con: 0, len: 52
selected layers: (1, 2, 4, 5), acc: 1.0
model acc: 1.0

label: 0, total_len: 61, label_con: 1, len: 9
selected layers: (1, 2, 3, 4, 5), acc: 0.1111111111111111
model acc: 0.0

label: 1
label: 1, total_len: 0, label_con: 0, len: 0
check!
label: 1, total_len: 0, label_con: 1, len: 0
check!
