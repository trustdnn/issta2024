[name: "/device:CPU:0"
device_type: "CPU"
memory_limit: 268435456
locality {
}
incarnation: 16836893301257652456
xla_global_id: -1
]
Dense layers and associated activation layers are considered: ['dense', 'dense_1', 'dense_2', 'dense_3', 'dense_4', 'dense_5']
Number of classes: 2
[94m### y_train len:8462 ###[0m
[92m### y_valid len:1058 ###[0m
[94m[train] [0mModel serving

 1/67 [..............................] - ETA: 8s
41/67 [=================>............] - ETA: 0s
67/67 [==============================] - 0s 1ms/step
[94m[train] [0mProcessing ATs
Layer: dense
Layer: dense_1
Layer: dense_2
Layer: dense_3
Layer: dense_4
Layer: dense_5
[92mtrain ATs is saved at /experiments/comparison/selfchecker/1/BM8/train_dense_dense_1_dense_2_dense_3_dense_4_ats.npy[0m
[94m[valid] [0mModel serving

1/9 [==>...........................] - ETA: 0s
9/9 [==============================] - 0s 1ms/step
[94m[valid] [0mProcessing ATs
Layer: dense
Layer: dense_1
Layer: dense_2
Layer: dense_3
Layer: dense_4
Layer: dense_5
[92mvalid ATs is saved at /experiments/comparison/selfchecker/1/BM8/valid_dense_dense_1_dense_2_dense_3_dense_4_ats.npy[0m
[94mLayer: dense[0m
layer_index: 0, var_threshold: 1e-05
[94mcalc kdes...[0m

kde:   0%|          | 0/2 [00:00<?, ?it/s]refined ats shape: (63, 4197)
refined ats min max 0.0 ; 12431.986328125 
min_kde: 8.170183880840818e-62
max_kde: 2.130285357009462e-61

kde:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:01<00:01,  1.22s/it]refined ats shape: (63, 4265)
refined ats min max 0.0 ; 10220.634765625 
LinAlgError: singular matrix
refined_ats shape: (63, 4265)
refined_ats min max 0.0 ; 10220.634765625 
Regularizing KDE
min_kde: 5.374576131902512e-62
max_kde: 2.6869593647380814e-61

kde: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:02<00:00,  1.24s/it]
kde: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:02<00:00,  1.24s/it]
gaussian_kde(refined_ats) shape[1] sum: 8462
[92mThe number of removed columns: 1[0m
[94m[dense] [0mFetching KDE inference

valid:   0%|          | 0/2 [00:00<?, ?it/s]
valid:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  2.87it/s]
valid: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  2.82it/s]
valid: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  2.83it/s]
model accuracy: valid, 0.5406427221172023
kde accuracy:valid, 0.7854442344045368
[94mLayer: dense_1[0m
layer_index: 1, var_threshold: 0
[94mcalc kdes...[0m

kde:   0%|          | 0/2 [00:00<?, ?it/s]refined ats shape: (32, 4197)
refined ats min max 0.0 ; 4685.24853515625 
LinAlgError: singular matrix
refined_ats shape: (32, 4197)
refined_ats min max 0.0 ; 4685.24853515625 
Regularizing KDE
min_kde: 2.6529903065402985e-22
max_kde: 9.673181801720744e-20

kde:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  1.42it/s]refined ats shape: (32, 4265)
refined ats min max 0.0 ; 3746.3232421875 
LinAlgError: singular matrix
refined_ats shape: (32, 4265)
refined_ats min max 0.0 ; 3746.3232421875 
Regularizing KDE
min_kde: 2.4112021085402903e-18
max_kde: 7.514962226886709e-16

kde: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:01<00:00,  1.39it/s]
kde: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:01<00:00,  1.39it/s]
gaussian_kde(refined_ats) shape[1] sum: 8462
[92mThe number of removed columns: 0[0m
[94m[dense_1] [0mFetching KDE inference

valid:   0%|          | 0/2 [00:00<?, ?it/s]
valid:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  4.54it/s]
valid: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  4.44it/s]
valid: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  4.45it/s]
model accuracy: valid, 0.5406427221172023
kde accuracy:valid, 0.5699432892249527
[94mLayer: dense_2[0m
layer_index: 2, var_threshold: 0
[94mcalc kdes...[0m

kde:   0%|          | 0/2 [00:00<?, ?it/s]refined ats shape: (16, 4197)
refined ats min max 0.0 ; 2776.77294921875 
LinAlgError: singular matrix
refined_ats shape: (16, 4197)
refined_ats min max 0.0 ; 2776.77294921875 
Regularizing KDE
min_kde: 2.830870722518121e-17
max_kde: 3.050223406924852e-14

kde:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  2.34it/s]refined ats shape: (16, 4265)
refined ats min max 0.0 ; 2292.13232421875 
LinAlgError: singular matrix
refined_ats shape: (16, 4265)
refined_ats min max 0.0 ; 2292.13232421875 
Regularizing KDE
min_kde: 6.43141585529301e-14
max_kde: 5.2852745305258305e-11

kde: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  2.31it/s]
kde: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  2.31it/s]
gaussian_kde(refined_ats) shape[1] sum: 8462
[92mThe number of removed columns: 0[0m
[94m[dense_2] [0mFetching KDE inference

valid:   0%|          | 0/2 [00:00<?, ?it/s]
valid:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  6.36it/s]
valid: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.26it/s]
valid: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  6.27it/s]
model accuracy: valid, 0.5406427221172023
kde accuracy:valid, 0.5151228733459358
[94mLayer: dense_3[0m
layer_index: 3, var_threshold: 0
[94mcalc kdes...[0m

kde:   0%|          | 0/2 [00:00<?, ?it/s]refined ats shape: (8, 4197)
refined ats min max 0.0 ; 436.2059020996094 
LinAlgError: singular matrix
refined_ats shape: (8, 4197)
refined_ats min max 0.0 ; 436.2059020996094 
Regularizing KDE
min_kde: 1.0335530591472051e-09
max_kde: 1.7336985064167371e-06

kde:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  3.69it/s]refined ats shape: (8, 4265)
refined ats min max 0.0 ; 128.990234375 
LinAlgError: singular matrix
refined_ats shape: (8, 4265)
refined_ats min max 0.0 ; 128.990234375 
Regularizing KDE
min_kde: 0.0001215310130011812
max_kde: 0.3736104567007599

kde: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  3.25it/s]
kde: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  3.31it/s]
gaussian_kde(refined_ats) shape[1] sum: 8462
[92mThe number of removed columns: 0[0m
[94m[dense_3] [0mFetching KDE inference

valid:   0%|          | 0/2 [00:00<?, ?it/s]
valid: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 13.92it/s]
valid: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 13.91it/s]
model accuracy: valid, 0.5406427221172023
kde accuracy:valid, 0.5614366729678639
[94mLayer: dense_4[0m
layer_index: 4, var_threshold: 0
[94mcalc kdes...[0m

kde:   0%|          | 0/2 [00:00<?, ?it/s]refined ats shape: (4, 4197)
refined ats min max 0.0 ; 332.209228515625 
min_kde: 0.028660979939945493
max_kde: 38.885644123032655

kde:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  4.75it/s]refined ats shape: (4, 4265)
refined ats min max 0.0 ; 38.93962097167969 
LinAlgError: singular matrix
refined_ats shape: (4, 4265)
refined_ats min max 0.0 ; 38.93962097167969 
Regularizing KDE
min_kde: 0.00017750423743941908
max_kde: 0.5402805212145744

kde: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  4.13it/s]
kde: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  4.21it/s]
gaussian_kde(refined_ats) shape[1] sum: 8462
[92mThe number of removed columns: 0[0m
[94m[dense_4] [0mFetching KDE inference

valid:   0%|          | 0/2 [00:00<?, ?it/s]
valid: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 17.43it/s]
valid: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 17.42it/s]
model accuracy: valid, 0.5406427221172023
kde accuracy:valid, 0.5396975425330813
[94mLayer: dense_5[0m
layer_index: 5, var_threshold: 0
[94mcalc kdes...[0m

kde:   0%|          | 0/2 [00:00<?, ?it/s]refined ats shape: (1, 4197)
refined ats min max 0.0 ; 0.8717281818389893 
min_kde: 0.44236260056127935
max_kde: 2.8549646442320324

kde:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 1/2 [00:00<00:00,  6.05it/s]refined ats shape: (1, 4265)
refined ats min max 0.00038976455107331276 ; 0.8717281818389893 
min_kde: 0.047036198407766856
max_kde: 5.994982098526892

kde: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  5.15it/s]
kde: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00,  5.26it/s]
gaussian_kde(refined_ats) shape[1] sum: 8462
[92mThe number of removed columns: 0[0m
[94m[dense_5] [0mFetching KDE inference

valid:   0%|          | 0/2 [00:00<?, ?it/s]
valid: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2/2 [00:00<00:00, 22.03it/s]
model accuracy: valid, 0.5406427221172023
kde accuracy:valid, 0.8156899810964083
label: 0
count: 1
count: 2
count: 3
count: 4
count: 5
count: 6
selected layers: (5,)
TPR:0.864198 FPR:0.225524 F1:0.811594 TP:420 FP:129 FN:66 TN:443
label: 1
count: 1
count: 2
count: 3
count: 4
count: 5
count: 6
selected layers: (0, 1, 2, 3, 4, 5)
TPR:0.000000 FPR:0.000000 F1:0.000000 TP:0 FP:0 FN:0 TN:0
label: 0
label: 0, total_len: 549, label_con: 0, len: 129
selected layers: (4, 5), acc: 1.0
model acc: 1.0

label: 0, total_len: 549, label_con: 1, len: 420
selected layers: (0, 1, 2, 3, 4, 5), acc: 1.0
model acc: 0.0

label: 1
label: 1, total_len: 0, label_con: 0, len: 0
check!
label: 1, total_len: 0, label_con: 1, len: 0
check!
label: 0
label: 0, total_len: 509, label_con: 0, len: 443
selected layers: (0, 3, 4, 5), acc: 1.0
model acc: 1.0

label: 0, total_len: 509, label_con: 1, len: 66
selected layers: (3,), acc: 0.9848484848484849
model acc: 0.0

label: 1
label: 1, total_len: 0, label_con: 0, len: 0
check!
label: 1, total_len: 0, label_con: 1, len: 0
check!
